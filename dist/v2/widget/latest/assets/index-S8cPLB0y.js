const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./browser-BYuZYzs8.js","./main-vendor-N2Dp62kv.js"])))=>i.map(i=>d[i]);
var te=Object.defineProperty;var ne=(t,n,s)=>n in t?te(t,n,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[n]=s;var E=(t,n,s)=>ne(t,typeof n!="symbol"?n+"":n,s);import{l as se,_ as B,p as ae,u as oe,a as ie,b as re,c as ce,d as le,e as L,s as ue,W as de,f as S,g as m,P as g,h as z,i as D,j as _e,k as fe,m as I,R as ge,n as he,o as M,q as pe,r as me,t as Ce,v as xe,w as Se,x as be,y as we,z as je,A as Ee,B as ve,C as N,D as Re,E as H,U as Ie,I as Le,F as Te,G as ye,H as ke,J as Ae,K as Fe,L as Be,M as Ne}from"./overlayscrollbars-DEpxyWX7.js";import{j as e,r as f,u as $,a as He,b as Pe,R as Oe}from"./main-vendor-N2Dp62kv.js";import"./reporter-vendor-BrFA8t6T.js";function ht(){import.meta.url,import("_").catch(()=>1),async function*(){}().next()}/*!
* Talkdesk Confidential
*
* Copyright (C) Talkdesk Inc. 2024
*
* The source code for this program is not published or otherwise divested
* of its trade secrets, irrespective of what has been deposited with the
* U.S. Copyright Office. Unauthorized copying of this file, via any medium
* is strictly prohibited.
*/async function v(t,n,s){try{s.debug("Load ".concat(t," start")),await n(),s.debug("Load ".concat(t," success"))}catch(o){s.warn("Load ".concat(t," failed"),o)}}function ze(){const t=se.getSubLogger({name:"PreLoader"});v("locales",()=>B(()=>import("./index-CGA_YNtO.js"),[],import.meta.url),t),v("@twilio/conversations",()=>B(()=>import("./browser-BYuZYzs8.js").then(n=>n.b),__vite__mapDeps([0,1]),import.meta.url),t),v("TextMessage",()=>ae(),t)}function De(){ze()}const Me="_loading_zncni_106",$e="_loader_zncni_113",Ue="_circle_zncni_1",P={loading:Me,loader:$e,"move-x":"_move-x_zncni_1",circle:Ue,"slide-down":"_slide-down_zncni_1","slide-in":"_slide-in_zncni_1","slide-out":"_slide-out_zncni_1","fade-in":"_fade-in_zncni_1","fade-out":"_fade-out_zncni_1"},O=()=>e.jsx("div",{className:P.loading,children:e.jsx("span",{className:P.loader,"data-testid":"loading-screen"})});function We(){const t=f.useRef(null),n=f.useRef(!1),{showInitialScreen:s}=oe(),{chatContainerHeight:o}=ie(),{autoOpen:r}=re(),{maximize:i,frameResize:a}=ce(),c=le(),l=L()===g.InitialScreen,h=f.useCallback(async _=>n.current?!1:(n.current=!0,c||r?(await ue(_),await i(),!0):!1),[c,r,i]),d=f.useCallback(async()=>{var _;if(!o&&t.current){let p=((_=t.current)==null?void 0:_.scrollHeight)||0;if(p>0){p+=de;const x=p<S?p:S;return await a({height:x}),x}}return S},[o,a]),C=f.useCallback(()=>o?!1:a({height:S}),[o,a]);return f.useEffect(()=>{c&&m.preloadClient("openChatWidget")},[c]),f.useEffect(()=>{const _=s&&l;return h(_?200:-1),_&&d(),()=>{_&&C()}},[s,l,h,d,C]),{initialScreenContainerRef:t,updateChatFrameHeight:d}}const Ge="_startChatButton_h3e07_19",Ve="_withSeparator_h3e07_27",qe="_button_h3e07_32",Je="_transparent_h3e07_56",b={startChatButton:Ge,withSeparator:Ve,button:qe,transparent:Je},Ke=t=>{const n=z(d=>d.config.options.startChatButtonLabel),[s]=$(),o=L(),r=D(),{active:i}=_e(),{scrollOffset:a,isBottom:c}=fe(),u=f.useRef(null),l=o===g.End&&!!r&&i;f.useEffect(()=>{var d;(d=u.current)==null||d.focus()},[]);const h=()=>{t.onClick()};return e.jsx("div",{className:I(b.startChatButton,{[b.withSeparator]:a>0&&!c}),children:e.jsxs("button",{ref:u,type:"button",className:I(b.button,{[b.transparent]:l}),onClick:h,children:[l&&e.jsx(ge,{}),e.jsx("p",{children:n||s("startChatButtonLabel")})]})})};function Xe(t){return"text"in t}function Ye(t){const{value:n}=t,[s]=$();return Xe(n)?e.jsx(e.Fragment,{children:n.text}):e.jsx(e.Fragment,{children:s(n.key,n.options)})}class Qe{constructor(n,s){E(this,"type");E(this,"content");this.type=n,this.content=s}}const Ze=He(t=>{const n=o=>{t(r=>({items:r.items.filter(i=>i.id!==o)}))},s=(o,r,i=5e3)=>{const a=he(),c={...new Qe(o,r),id:a};return t(u=>({items:[c,...u.items]})),i>0&&setTimeout(()=>{n(a)},i),a};return{items:[],error(o,r=5e3){const i=s("error",o,r);return()=>{n(i)}},warning(o,r=5e3){const i=s("warning",o,r);return()=>{n(i)}},success(o,r=5e3){const i=s("success",o,r);return()=>{n(i)}},remove(o){n(o)},clear(){t({items:[]})}}}),et="_notifications_1osrc_106",tt="_notification_1osrc_106",nt="_error_1osrc_131",st="_warning_1osrc_137",at="_success_1osrc_143",ot="_circle_1osrc_1",it="_loading_1osrc_1",R={notifications:et,notification:tt,"slide-down":"_slide-down_1osrc_1",error:nt,warning:st,success:at,circle:ot,loading:it,"move-x":"_move-x_1osrc_1","slide-in":"_slide-in_1osrc_1","slide-out":"_slide-out_1osrc_1","fade-in":"_fade-in_1osrc_1","fade-out":"_fade-out_1osrc_1"},rt=3,ct=3e3,lt=0;function ut(){const{items:t,error:n,success:s,clear:o}=Ze(),{on:r,off:i}=M();return f.useLayoutEffect(()=>{let a=null;const c=()=>{a==null||a(),a=null,a=n({key:"noConnectionTip"},lt)},u=()=>{a==null||a(),a=null,s({key:"connectedTip"},ct)},l=()=>{o()};return r("disconnect",c),r("reconnect",u),r("leave_end",l),r("leave_error",l),()=>{i("disconnect",c),i("reconnect",u),i("leave_end",l),i("leave_error",l)}},[r,i,n,s,o]),e.jsx(pe,{children:e.jsx("div",{className:R.notifications,children:t.slice(0,rt).map(a=>e.jsx("div",{className:I(R.notification,R[a.type]),children:e.jsx(Ye,{value:a.content})},a.id))})})}const U=()=>{const{showInitialScreen:t,welcomeMessage:n,controls:s,enableEmoji:o,enableAttachments:r,enableValidation:i,enableUserInput:a,chatTitle:c,chatSubtitle:u,showCloseConversationButton:l,showDownloadTranscriptButton:h,context:d}=me(),{initialScreenContainerRef:C,updateChatFrameHeight:_}=We(),{send:p,typing:x}=Ce(),W=xe(),w=L(),{go:T,isNot:G,getInitialPage:V,setFormData:q,enableScreenLoading:J}=Se(),K=be(),{emit:X}=we(),y=je(),k=Ee(),A=ve(),F=D(),Y=(j,ee=!1)=>{q(j),ee&&(J(1e4,!0),m.init("submitInitialScreen")),G(g.Conversation)&&T(g.Conversation)},Q=()=>{const j=V();T(j),m.clear(),X(Te.resetFrame),m.preloadClient("startNewChat")};function Z(){switch(w){case g.Loading:return e.jsx(O,{});case g.InitialScreen:return e.jsx(Le,{ref:C,active:t,welcomeMessage:n,controls:s,enableValidation:i,onSubmitInitialScreen:Y,defaultValues:d,updateChatFrameHeight:_});case g.Conversation:return e.jsxs(e.Fragment,{children:[e.jsx(H,{shouldLoadFeedback:A,feedbackLink:F,messages:k,page:w}),a&&e.jsx(Ie,{enableEmoji:o,enableAttachments:r,send:p,connected:W,typing:x,enableRTL:K,showScreenLoading:y})]});case g.Error:case g.End:return e.jsxs(e.Fragment,{children:[e.jsx(H,{shouldLoadFeedback:A,feedbackLink:F,messages:k,page:w}),e.jsx(Ke,{onClick:Q})]})}}return e.jsxs("div",{className:N.chat,children:[e.jsx(Re,{chatTitle:c,chatSubtitle:u,showCloseConversationButton:l,showDownloadTranscriptButton:h}),Z(),e.jsx(ut,{}),e.jsx("div",{"data-qa":"screen-loading",className:N.loadingWrapper,"aria-label":"loading conversation","aria-hidden":!y,children:e.jsx(O,{})})]})};U.whyDidYouRender=!0;function dt(){window.location.reload()}function _t(){return e.jsx(ye,{fallback:e.jsx(ke,{onRetry:dt}),onError:Ae,children:e.jsx(Fe,{children:e.jsx(U,{})})})}async function ft(){De(),M.getState().go("loading"),Be.getState().init(),await Ne.getState().frameReady(),await z.getState().init(),m.init("pageLoaded");const t=document.getElementById("root");Pe.createRoot(t).render(e.jsx(Oe.StrictMode,{children:e.jsx(_t,{})}))}ft();export{ht as __vite_legacy_guard};
